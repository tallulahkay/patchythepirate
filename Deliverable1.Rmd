---
title: "Data Description and EDA"
output: github_document
---

## Abstract

## Data Description

## Research Question
What is the effect of different country factors, such as population and gdp, and age of individuals on suicide rate within the past three decades?

## Data Import & Cleaning
```{r}
library(tidyverse)

(suicide <- read_csv("master.csv", col_names = TRUE, na = "") %>% filter(year >= 2006, country == c("United States", "Canada", "Mexico", "Belize", "Costa Rica", "El Salvador", "Guatemala", "Honduras", "Nicaragua", "Panama")) %>% select(country, year, sex, age, suicides_no, population, 'suicides/100k pop', 'country-year', 'gdp_per_capita ($)', generation))

problems(suicide)

mobile <- read_csv("mobile.csv", col_names = TRUE, na = "")
unemploy <- read_csv("unemployment.csv", col_names = TRUE, na="")
rural <- read_csv("rural_pop.csv", col_names = TRUE, na = "")

mobile <- mobile %>% gather(key = "year", value = "mobile_per100")

unemploy <- unemploy %>% gather(key = "year", value = "unemployment")

rural <- rural %>% gather(key = "year", value = "rural_pct")


yc <- suicide %>% count(`country-year`, wt = suicides_no)  
colnames(yc)[2] <- "total_suicide"

yc_2 <- suicide %>% count(`country-year`, wt = population)
colnames(yc_2)[2] <- "total_population"

suicide_cy <- left_join(yc, yc_2)

#suicide <- left_join(suicide, suicide_cy)
#suicide <- suicide %>% mutate('total_suicides/100k pop' = total_suicide / total_population * 100000)

#suicide <- merge(suicide, mobile, type = "left", match = "all")
#suicide <- merge(suicide, unemploy, type = "left", match = "all")
#suicide <- merge(suicide, rural, type = "left", match = "all")

#suicide_yc <- suicide %>% group_by(`country-year`) %>% summarize(`gdp_per_capita ($)` = mean(`gdp_per_capita ($)`), total_suicide = mean(total_suicide), total_population = mean(total_population), `total_suicides/100k pop` = mean(`total_suicides/100k pop`), mobile_per100 = mean(mobile_per100), unemployment = mean(unemployment), rural_pct = mean(rural_pct))

```


## Variation of Single Variables

```{r}
suicide %>% group_by(age) %>% ggplot(aes(age, log(`suicides/100k pop`))) + geom_point() + geom_boxplot()

suicide %>% group_by(country, year) %>% ggplot(aes(sex, log(`suicides/100k pop`))) + geom_boxplot()



```

## Covariation between Multiple Variables

```{r}

suicide 

suicide %>% group_by(country) %>% ggplot(aes(population,suicides_no)) + 
  geom_point(aes(color = country), position = "jitter") + geom_smooth()

suicide %>% group_by(country) %>% ggplot() + 
  geom_boxplot(aes(country, `suicides/100k pop`))

suicide %>% ggplot() + 
  geom_boxplot(aes(factor(year), `suicides/100k pop`))

```



## Discussion